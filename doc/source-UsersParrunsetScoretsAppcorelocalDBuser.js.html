<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
      <title>source: /Users/Parrunset/Scorets/App/core/localDB/user.js - documentation</title>
    
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,600,700|Source+Sans+Pro:400,700" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css">
    <link href="style.css" rel="stylesheet">
  </head>
  <body>
    <div class="overlay" id="menu-overlay" style="display: none;"></div>
    <div class="content column">
      <header class="row">
        <button class="show-mobile menu-toggle-button" id="toggle-menu">
          <i class="fa fa-bars"></i>
        </button>
        <a href="index.html">Home</a>

        
      </header>
      <div class="row flex">
        <div class="nav-menu" id="menu">
          <div class="column max-height-100" id="leftpane">
  <div class="doc-gutter doc-search-box">
    <input type="text" id="search" class="doc-search-input" placeholder="Search documentation" />
  </div>
  <div class="doc-menu-wrapper doc-gutter flex scroll-y" id="search-results">
    
    <div class="doc-menupath">Users/Parrunset/Score/buttons</div>
    <ul class="doc-menu">
      
        <li>
          <span title="module" class="letter-icon letter-icon-module">
            M
          </span>
          &nbsp;
          <a href="UsersParrunsetScorebuttons-buttons.html">buttons</a>
        </li>
      
    </ul>
    
    <div class="doc-menupath">swipable</div>
    <ul class="doc-menu">
      
        <li>
          <span title="constant" class="letter-icon letter-icon-constant">
            C
          </span>
          &nbsp;
          <a href="swipable-styles.html">styles</a>
        </li>
      
        <li>
          <span title="function" class="letter-icon letter-icon-function">
            F
          </span>
          &nbsp;
          <a href="swipable-render.html">render</a>
        </li>
      
    </ul>
    
    <div class="doc-menupath">Users/Parrunset/Score/errorHandlers</div>
    <ul class="doc-menu">
      
        <li>
          <span title="module" class="letter-icon letter-icon-module">
            M
          </span>
          &nbsp;
          <a href="UsersParrunsetScoreerrorHandlers-errorHandlers.html">errorHandlers</a>
        </li>
      
    </ul>
    
    <div class="doc-menupath">Users/Parrunset/Scorets/App/core/loca/index</div>
    <ul class="doc-menu">
      
        <li>
          <span title="module" class="letter-icon letter-icon-module">
            M
          </span>
          &nbsp;
          <a href="UsersParrunsetScoretsAppcorelocaindex-localDB.html">localDB</a>
        </li>
      
    </ul>
    
    <div class="doc-menupath">Users/Parrunset/Score/loggers</div>
    <ul class="doc-menu">
      
        <li>
          <span title="module" class="letter-icon letter-icon-module">
            M
          </span>
          &nbsp;
          <a href="UsersParrunsetScoreloggers-loggers.html">loggers</a>
        </li>
      
    </ul>
    
    <div class="doc-menupath">Users/Parrunset/Score/servers</div>
    <ul class="doc-menu">
      
        <li>
          <span title="module" class="letter-icon letter-icon-module">
            M
          </span>
          &nbsp;
          <a href="UsersParrunsetScoreservers-servers.html">servers</a>
        </li>
      
    </ul>
    
    <div class="doc-menupath">Users/Parrunset/Score/texts</div>
    <ul class="doc-menu">
      
        <li>
          <span title="module" class="letter-icon letter-icon-module">
            M
          </span>
          &nbsp;
          <a href="UsersParrunsetScoretexts-texts.html">texts</a>
        </li>
      
    </ul>
    
    <div class="doc-menupath">Users/Parrunset/Score/trackers</div>
    <ul class="doc-menu">
      
        <li>
          <span title="module" class="letter-icon letter-icon-module">
            M
          </span>
          &nbsp;
          <a href="UsersParrunsetScoretrackers-trackers.html">trackers</a>
        </li>
      
    </ul>
    
  </div>

</div>
<script>
  // define a global JS client containing menu data object for search
  
  // global containing menu data
  window.__MENUDATA = {"_Users/Parrunset/Score/buttons":[{"name":"buttons","kind":"module","recordUrl":"UsersParrunsetScorebuttons-buttons.html"}],"_swipable":[{"name":"styles","scope":"global","kind":"constant","recordUrl":"swipable-styles.html"},{"name":"render","scope":"global","kind":"function","recordUrl":"swipable-render.html"}],"_Users/Parrunset/Score/errorHandlers":[{"name":"errorHandlers","kind":"module","recordUrl":"UsersParrunsetScoreerrorHandlers-errorHandlers.html"}],"_Users/Parrunset/Scorets/App/core/loca/index":[{"name":"localDB","kind":"module","recordUrl":"UsersParrunsetScoretsAppcorelocaindex-localDB.html"}],"_Users/Parrunset/Scorets/App/core/loca/log":[],"_User/log":[],"_User/team":[],"_User/user":[],"_Users/Parrunset/Scorets/App/core/loca/user":[],"_Users/Parrunset/Score/loggers":[{"name":"loggers","kind":"module","recordUrl":"UsersParrunsetScoreloggers-loggers.html"}],"_Users/Parrunset/Score/servers":[{"name":"servers","kind":"module","recordUrl":"UsersParrunsetScoreservers-servers.html"}],"_Users/Parrunset/Score/texts":[{"name":"texts","kind":"module","recordUrl":"UsersParrunsetScoretexts-texts.html"}],"_Users/Parrunset/Score/trackers":[{"name":"trackers","kind":"module","recordUrl":"UsersParrunsetScoretrackers-trackers.html"}]};
</script>

        </div>
        <div class="flex scroll-y">
          <div class="doc-gutter">
  <h1>Source: /Users/Parrunset/Scorets/App/core/localDB/user.js</h1>
  <hr />
  <pre>
    <code>
import Realm from './index';
import { ErrorHandler } from 'core/errorHandlers';
import { LoggerRealm } from 'core/loggers';


/***************************************************************************************************/
/* UUID GENERATOR **********************************************************************************/
/***************************************************************************************************/
//
// A simple UUID generator. Returns a string.
//
// It avoids collision using date in its generator
//
// ## Sample code:
// generateUUID()
//
function generateUUID() { // Public Domain/MIT
  var d = new Date().getTime();
  if (typeof performance !== 'undefined' && typeof performance.now === 'function') {
    d += performance.now(); //use high-precision timer if available
  }
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
    var r = (d + Math.random() * 16) % 16 | 0;
    d = Math.floor(d / 16);
    return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);
  });
}
/***************************************************************************************************/
/***************************************************************************************************/


/***************************************************************************************************/
/* CREATE USER *************************************************************************************/
/***************************************************************************************************/
/** 
 * 
 * Creates user and stores it to localDB.
 * Creates logs and catches errors to send to ErrorHandler
 * 
 * @constructor UserCreate
 * @extends UserSchema
 * @memberof module:localDB
 *
 * @example
 * UserCreate(params)
 *
 */
export
  const UserCreate = (params) => {
    const logRealm = new LoggerRealm('localDB - UserCreate')
    try {
      Realm.write(() => {
        const user = Object.assign({ id: generateUUID() }, params);
        let team = Realm.create('User', user);
      });
      logRealm.done()
    } catch (e) {
      logRealm.error(e)
      ErrorHandler(logRealm.name, e);
    }
  }
/***************************************************************************************************/
/***************************************************************************************************/


/***************************************************************************************************/
/* GET USERS ***************************************************************************************/
/***************************************************************************************************/
/** 
 * 
 * Gets all users from localDB.
 * Creates logs
 * 
 * @constructor UserGetAll
 * @extends UserSchema
 * @memberof module:localDB
 *
 * @example
 * UserGetAll(params)
 *
 */
export
  const UserGetAll = () => {
    const logRealm = new LoggerRealm('localDB - UserGetAll')
    const users = Realm.objects('User')
    logRealm.done()
    return Array.from(users);
  }
/***************************************************************************************************/
/***************************************************************************************************/


/***************************************************************************************************/
/* GET USER ****************************************************************************************/
/***************************************************************************************************/
/** 
 * 
 * Gets user and from localDB.
 * Creates logs
 * 
 * @param {string} id
 * 
 * @constructor UserGet
 * @extends UserSchema
 * @memberof module:localDB
 *
 * @example
 * UserGet(params)
 *
 */
export
  const UserGet = (id) => {
    const logRealm = new LoggerRealm('localDB - UserGet')
    const user = Realm.objects('User').filtered(`id = "${id}"`)[0];
    logRealm.done()
    return user;
  }
/***************************************************************************************************/
/***************************************************************************************************/


/***************************************************************************************************/
/* UPDATE USER *************************************************************************************/
/***************************************************************************************************/
/** 
 * 
 * Updates user and stores it to localDB.
 * Creates logs and catches errors to send to ErrorHandler
 * Throws errors on invalid keys because the catcher on update with wrong params doesn't react
 * 
 * @param {string} id
 * @param {object} params See UserSchema
 * 
 * @constructor UserUpdate
 * @extends UserSchema
 * @memberof module:localDB
 *
 * @example
 * UserUpdate(id, params)
 *
 */
export
  const UserUpdate = (id, params) => {
    const logRealm = new LoggerRealm('localDB - UserUpdate')
    logRealm.message(id)
    try {
      Realm.write(() => {
        let user = Realm.objects('User').filtered(`id = "${id}"`)[0];
        Object.keys(params).forEach(key => {
          if (user[key] === undefined) throw `Key "${key}" not valid`
          else user[key] = params[key]
        })
      })
      logRealm.done()
    } catch (e) {
      logRealm.error(e)
      ErrorHandler(logRealm.name, e)
    }
  }
/***************************************************************************************************/
/***************************************************************************************************/


/***************************************************************************************************/
/* DELETE USER *************************************************************************************/
/***************************************************************************************************/
/** 
 * 
 * Deletes user from localDB.
 * Creates logs and catches errors to send to ErrorHandler
 * 
 * @param {string} id
 * 
 * @constructor UserUpdate
 * @extends UserSchema
 * @memberof module:localDB
 *
 * @example
 * UserDelete(id)
 *
 */
export
  const UserDelete = (id) => {
    const logRealm = new LoggerRealm('localDB - UserDelete')
    try {
      Realm.write(() => {
        const user = Realm.objects('User').filtered(`id = "${id}"`)[0];
        Realm.delete(user);
      })
      logRealm.done();
    } catch (e) {
      logRealm.error(e)
      ErrorHandler(logRealm.name, e);
    }
  }
/***************************************************************************************************/
/***************************************************************************************************/


/***************************************************************************************************/
/* DELETE USERS ************************************************************************************/
/***************************************************************************************************/
/** 
 * 
 * Deletes all users from localDB.
 * Creates logs and catches errors to send to ErrorHandler
 * 
 * @constructor UserDeleteAll
 * @extends UserSchema
 * @memberof module:localDB
 *
 * @example
 * UserDeleteAll(id)
 *
 */
export
  const UserDeleteAll = () => {
    const logRealm = new LoggerRealm('localDB - UserDeleteAll')
    try {
      Realm.write(() => {
        let allUsers = Realm.objects('User');
        Realm.delete(allUsers);
      })
      logRealm.done()
    } catch (e) {
      logRealm.error()
      ErrorHandler(logRealm.name, e);
    }
  }
/***************************************************************************************************/
/***************************************************************************************************/
</code>
  </pre>
</div>

        </div>
      </div>
    </div>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
    <script>
      // syntax highlight code
      document.querySelectorAll('pre code').forEach(el => hljs.highlightBlock(el));
      
      // spoiler code
      function toggle(element) {
        if (element.style.display === 'block') {
          element.style.display = 'none';
        } else {
          element.style.display = 'block';
        }
      }

      document.querySelectorAll('[data-spoiler-button]').forEach(button => {
        const spoilElementId = button.getAttribute('data-spoiler-button');
        const spoilElement = document.querySelector(`[data-spoiler="${spoilElementId}"]`);

        if (spoilElement) {
          button.addEventListener('click', () => toggle(spoilElement));
        }
      });

      // toggle menu mobile nav code
      const menu = document.getElementById('menu');
      const toggleMenuBtn = document.getElementById('toggle-menu');
      const menuOverlay = document.getElementById('menu-overlay');

      function openMenu() {
        menu.className += ' open';
        menuOverlay.style.display = 'block';
        setTimeout(() => menuOverlay.className += ' open', 1);
      }

      function closeMenu() {        
        menu.className = menu.className.replace('open', '');
        menuOverlay.className = menuOverlay.className.replace('open', '');
        setTimeout(() => menuOverlay.style.display = 'none', 300);
      }

      function toggleMenu() {
        if (menu.className.indexOf('open') !== -1) {
          closeMenu();
        } else {
          openMenu();
        }
      }

      toggleMenuBtn.addEventListener('click', toggleMenu);
      menuOverlay.addEventListener('click', closeMenu);

      // search menu
      console.log(__MENUDATA);
      const leftpane = document.getElementById('leftpane');
      const searchField = document.getElementById('search');
      const searchResults = document.getElementById('search-results');
      // fix menu width for search
      leftpane.style.width = `${leftpane.offsetWidth}px`;

      function renderMenu(results) {
        let html = '';

        Object.keys(results).forEach((menupath) => {
          html += `<div class="doc-menupath">${menupath.slice(1, menupath.length)}</div>`;
          html += '<ul class="doc-menu">';
          html += results[menupath].map(symbol => `<li>
            <span title="${symbol.kind}" class="letter-icon letter-icon-${symbol.kind}">${symbol.kind[0]}</span>
            <a href="${symbol.recordUrl}">${symbol.name}</a>
          </li>`).join('');
          html += '</ul>';
        });

        if (html === '') {
          html = '<p>No results.</p>';
        }

        searchResults.innerHTML = html;
      }

      searchField.addEventListener('keyup', (event) => {
        const searchStr = event.target.value.toLowerCase();

        const results = {};

        Object.keys(__MENUDATA).forEach((menupath) => {
          const matches = [];

          __MENUDATA[menupath].forEach((symbol) => {
            if (symbol.name.toLowerCase().indexOf(searchStr) !== -1) {
              matches.push(symbol);
            }
          });

          if (matches.length) {
            results[menupath] = matches;
          }
        });

        renderMenu(results);
      });
    </script>
  </body>
</html>
